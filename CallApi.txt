function createTagsFromSubject() {
 CallApi();
 return

  var taskLists=Tasks.Tasklists.list();
  var taslkList=taskLists.items[0]
  var tasks=Tasks.Tasks.list(taslkList.id)
  for(var i=0;i<tasks.items.length;i++){
    var task=tasks.items[i]
    var title=task.title;
    var link=task.links[0].link;
    var notes=task.notes;
    Logger.log(title);
    Logger.log(link);
    Logger.log(notes);
   // DeleteTask(taslkList.id,task.id)
  }
}

function DeleteTask(taskListId, taskId)
{
  Tasks.Tasks.remove(taskListId,taskId)
}

function CallApi()
{
  var customToken=GetCustomToken();
  var idKey=GetIdToken(customToken)
  CreateTask(idKey)
}

function CreateTask(idKey)
{
  Logger.log(idKey);
  var url='https://apigettask3.productivitytools.top:8040/api/Task/Add'

  var bearer="Bearer "+idKey;
  var data = {"ParentId":46293,
    "Name":"xxxfsdafa",
    "Details":"hhh",
    "DetailsType":"",
    "Finished":false
  }
  //var data2={"elementId":null,"path":null}
  var options = {
    'method' : 'post',
    'contentType': 'application/json',
    'headers':{
      'authorization':bearer
     },
    'payload' : JSON.stringify(data)
  };
  Logger.log(url);
  Logger.log(options);

  var response=UrlFetchApp.fetch(url, options);
  var responseText=response.getContentText()
  Logger.log(responseText);
}

function GetCustomToken()
{
  var url = 'https://apigettask3.productivitytools.top:8040/api/CustomToken/Get'

  var response = UrlFetchApp.fetch(url);
  var customToken=response.getContentText();
  Logger.log(customToken);
  return customToken;
  Logger.log(response);
}

function GetIdToken(customToken)
{
  Logger.log("Hello GetIdToken")
  var webApiKey=PropertiesService.getScriptProperties().getProperty("webapikey");
  var url='https://identitytoolkit.googleapis.com/v1/accounts:signInWithCustomToken?key='+webApiKey;

  var data = {
  'token': customToken,
  'returnSecureToken': true,
  };
  var options = {
    'method' : 'post',
    'contentType': 'application/json',
    // Convert the JavaScript object to a JSON string.
    'payload' : JSON.stringify(data)
  };
  var response=UrlFetchApp.fetch(url, options);
  var idKeyObject=response.getContentText()
  var idKey=JSON.parse(idKeyObject).idToken
  return idKey
}